<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Boutique Imagino 🛒</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap">
    <style>
        body { font-family: 'Poppins', Arial, sans-serif; margin:0; padding:0; background-color: #f4f7fc; }
        .container { display: flex; justify-content: center; flex-wrap: wrap; padding: 20px; }
        .cart { position: fixed; top: 15px; right: 15px; background: #6D28D9; color: white; padding: 10px; border-radius: 4px; cursor: pointer; }
        .cart-preview { position: absolute; top: 40px; right: 0; background: white; border-radius: 8px; padding: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1); display: none; }
        .cart:hover .cart-preview { display: block; }
        .cart-item img { width: 30px; height: 30px; object-fit: contain; }
        .carousel { display: flex; overflow-x: auto; gap: 20px; justify-content: center; padding: 20px; }
        .carousel img { width: 200px; }
    </style>
</head>
<body>

<header>
    <h1>Boutique Imagino 🛍️</h1>
</header>

<!-- Panier avec prévisualisation -->
<div class="cart">
    <a href="panier.html">🛒 Panier : <span id="cartCount">0</span></a>
    <div class="cart-preview" id="cartPreview"></div>
</div>

<div class="container">
    <div class="product">
        <img src="cdp.png" alt="CDP Imagino">
        <h3>Customer Data Platform</h3>
        <strong>99€</strong>
        <button onclick="ajouterAuPanier('CDP Imagino', 99, 'cdp.png')">Ajouter</button>
    </div>
    <div class="product">
        <img src="campaign.png" alt="Imagino Campaign">
        <h3>Imagino Campaign</h3>
        <strong>149€</strong>
        <button onclick="ajouterAuPanier('Imagino Campaign', 149, 'campaign.png')">Ajouter</button>
    </div>
    <div class="product">
        <img src="cachan.png" alt="Petit Déjeuner">
        <h3>Petit Déjeuner</h3>
        <strong>29€</strong>
        <button onclick="ajouterAuPanier('Petit Déjeuner', 29, 'cachan.png')">Ajouter</button>
    </div>
</div>

<!-- Carrousel des références clients -->
<section>
    <h2>Nos références clients</h2>
    <div class="carousel">
        <img src="client1.png" alt="Client 1">
        <img src="client2.png" alt="Client 2">
        <img src="client3.png" alt="Client 3">
    </div>
</section>

<!-- Inscription Newsletter -->
<div style="text-align:center; padding:20px; background:#fff;">
    <h2>Inscription à la newsletter 📧</h2>
    <form id="newsletterForm">
        <input type="email" placeholder="Votre email" id="email" required>
        <button type="button" onclick="inscrireUtilisateur()">S'inscrire</button>
    </form>
    <p id="messageValidation"></p>
</div>

<footer>
    <p>© Imagino – <a href="#">Mentions légales</a></p>
</footer>

<script>
// Gestion du panier et vérification d'email
let panier = JSON.parse(localStorage.getItem('panier') || '[]');
function ajouterAuPanier(nom, prix, image) {
    panier.push({ nom, prix, image });
    localStorage.setItem('panier', JSON.stringify(panier));
    afficherPanier();
}
function afficherPanier() {
    document.getElementById('cartCount').textContent = panier.length;
    let preview = panier.map(p => `<div><img src="${p.image}" alt="${p.nom}"> ${p.nom} - ${p.prix}€</div>`).join('');
    document.getElementById('cartPreview').innerHTML = preview || "<p>Panier vide</p>";
}
document.addEventListener('DOMContentLoaded', afficherPanier);
async function inscrireUtilisateur() {
    let email = document.getElementById('email').value.trim();
    let message = document.getElementById('messageValidation');

    if (!email.includes('@') || !email.includes('.')) {
        message.style.color = "red";
        message.innerText = "❌ Veuillez entrer une adresse email valide.";
        return;
    }

    message.style.color = "blue";
    message.innerText = "🔍 Vérification en cours...";

    try {
        let response = await fetch(`https://francois-sandbox.saas.imagino.com/ucdapi/New_customer/2/RCU?exact_email=${encodeURIComponent(email)}`, {
            method: 'GET',
            headers: {
                'X-API-KEY': '2a79b8c4-b270-4a61-8b64-437ccea75586',
                'Content-Type': 'application/json'
            }
        });

        if (!response.ok) {
            throw new Error(`Erreur API: ${response.status}`);
        }

        let data = await response.json();

        if (data && data.length > 0) {
            message.style.color = "green";
            message.innerText = "✅ Email valide ! Inscription en cours...";
            setTimeout(() => { alert("Inscription réussie !"); }, 1000);
        } else {
            message.style.color = "red";
            message.innerText = "❌ Cette adresse email n'existe pas.";
        }

    } catch (error) {
        message.style.color = "red";
        message.innerText = "❌ Erreur lors de la vérification. Réessayez plus tard.";
        console.error("Erreur API:", error);
    }
}
</script>

</body>
</html>
